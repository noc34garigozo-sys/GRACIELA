<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Vers√≠culo - Inspirado por ti</title>

  <!-- Evitar cache en la pagina -->
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <style>
    :root{
      --bg1: #f5f7fa;
      --bg2: #c3e7ff;
      --card-bg: rgba(255,255,255,0.9);
      --accent: #2b6cb0;
      --muted: #6b7280;
    }
    html,body{height:100%;margin:0;font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;-webkit-font-smoothing:antialiased;}
    body{
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
    }

    .container{
      width:100%;
      max-width:820px;
      padding:24px;
      border-radius:18px;
      box-shadow: 0 12px 40px rgba(20,30,60,0.12);
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.9));
      text-align:center;
    }

    .header {
      font-size:0.95rem;
      color:var(--muted);
      margin-bottom:10px;
    }

    .inspired {
      display:inline-block;
      background: linear-gradient(90deg,#ffd89b,#19547b);
      color:white;
      padding:8px 14px;
      border-radius:999px;
      font-weight:600;
      box-shadow: 0 6px 18px rgba(9,30,66,0.09);
      margin-bottom:18px;
    }

    .card {
      padding:28px 22px;
      border-radius:14px;
      background: var(--card-bg);
      box-shadow: 0 8px 30px rgba(15, 40, 70, 0.06);
      margin-top:8px;
    }

    .title {
      font-size:1.1rem;
      color:var(--accent);
      font-weight:700;
      margin-bottom:12px;
    }

    .verse {
      font-size: clamp(16px, 4.6vw, 28px);
      line-height:1.3;
      color:#0f1724;
      margin-bottom:12px;
      transition: transform 220ms ease, opacity 220ms ease;
      opacity: 0;
      transform: translateY(6px);
    }
    .verse.show { opacity: 1; transform: none; }

    .ref {
      font-size:0.95rem;
      color:var(--muted);
      margin-top:8px;
    }

    .btn {
      display:inline-block;
      margin-top:16px;
      padding:10px 16px;
      border-radius:999px;
      background: linear-gradient(90deg,#2b6cb0,#4f9cfb);
      color:white;
      font-weight:700;
      text-decoration:none;
      border:none;
      cursor:pointer;
      box-shadow: 0 8px 20px rgba(43,108,176,0.18);
    }

    /* responsive */
    @media (max-width:420px){
      .container{padding:16px;}
      .card{padding:20px;}
    }
  </style>
</head>
<body>
  <div class="container" role="main" aria-live="polite">
    <div class="header">Haz scan al QR o abre esta p√°gina desde tu manilla</div>

    <!-- FRASE ENCIMA DEL VERSO -->
    <div class="inspired">‚ú® PARA GRACIELA ‚ú®</div>

    <div class="card" id="card">
      <div class="title">üìñ Vers√≠culo</div>
      <div id="verse" class="verse">Cargando vers√≠culo...</div>
      <div id="ref" class="ref"></div>
      <button id="newBtn" class="btn" aria-label="Obtener otro vers√≠culo">Otro vers√≠culo</button>
    </div>
  </div>

  <script>
    // --- REEMPLAZA ESTA CONSTANTE con tu Apps Script Web App URL (la que termina en /exec)
    const API_URL = 'https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLhNRt3WxUcyhEVuqwXxPJmmpl1Tk5hpm00vm8l5Kj12_Bz5rB4Ss5ienncdlOM0a_yfPujf8LlTLM7XE17dG0IJaNWIu9KSUs-1m-LO0o5IqfjDzuKcOgBLVFl8MlWSAkWwhBbXBFTVM0lwgz6mbKCJvFeBiszLyn36HQWXBCTwhhdD3qyiDDNOZNNxB0P4LRl1Fetl12QLeD3i9xav_-kmqpdN5x0tUt03hRGrUGoyoDzZ6lluCxc6qqpCh3-oSOuhLM5rPEES8JKKBV73AnMni4VTz80_6djbWYsm&lib=MEwd4MNM1mgaZT9U4-GVYSNvTcetvNt65';

    const verseEl = document.getElementById('verse');
    const refEl = document.getElementById('ref');
    const btn = document.getElementById('newBtn');

    async function loadVerse() {
      try {
        // cache-bust + forzar no-cache
        const url = API_URL + (API_URL.includes('?') ? '&' : '?') + '_t=' + Date.now();
        const res = await fetch(url, { cache: "no-store" });
        const data = await res.json().catch(()=>({ verse: res.statusText || 'error' }));
        if (data.error) {
          verseEl.textContent = 'Error: ' + data.error;
          verseEl.classList.add('show');
          return;
        }
        const text = data.verse || '';
        verseEl.textContent = text;
        // Apariencia animada
        setTimeout(()=> verseEl.classList.add('show'), 30);
        // Ajuste de tama√±o si es muy largo
        const len = text.length;
        verseEl.style.fontSize = len < 80 ? '28px' : (len < 160 ? '22px' : '18px');
      } catch (err) {
        verseEl.textContent = 'Error cargando el vers√≠culo. Intenta de nuevo.';
        verseEl.classList.add('show');
        console.error(err);
      }
    }

    btn.addEventListener('click', () => {
      verseEl.classList.remove('show');
      setTimeout(loadVerse, 150);
    });

    // carga inicial
    loadVerse();
  </script>
</body>
</html>
